import pandas as pd
from app.services import preprocess_record  # now works via __init__

record = [
    146841, 0, 0.689079823, 1, 156067.3398, 0, 1, 1, 55, 1,
    0.794423413, 0.795942905, 1, 1, 0.131910422, 0, 0.627334163, 0.483031808,
    0.212211825, 0.134633693, 1, 0.442285369, 1.593022887, 0, 0, 0.483031808,
    0.406779661, 0, 0, 0, 0
]

columns = [
    "ID","AMOUNT_RUB_CLO_PRC","SUM_TRAN_AUT_TENDENCY3M","CNT_TRAN_AUT_TENDENCY3M","REST_AVG_CUR",
    "CR_PROD_CNT_TOVR","TRANS_COUNT_ATM_PRC","AMOUNT_RUB_ATM_PRC","AGE","CNT_TRAN_MED_TENDENCY3M",
    "SUM_TRAN_MED_TENDENCY3M","SUM_TRAN_CLO_TENDENCY3M","CNT_TRAN_CLO_TENDENCY3M","CNT_TRAN_SUP_TENDENCY3M",
    "TURNOVER_DYNAMIC_CUR_1M","REST_DYNAMIC_PAYM_3M","SUM_TRAN_SUP_TENDENCY3M","SUM_TRAN_ATM_TENDENCY3M",
    "SUM_TRAN_SUP_TENDENCY1M","SUM_TRAN_ATM_TENDENCY1M","CNT_TRAN_SUP_TENDENCY1M","TURNOVER_DYNAMIC_CUR_3M",
    "CLNT_SETUP_TENOR","TURNOVER_DYNAMIC_PAYM_3M","TURNOVER_DYNAMIC_PAYM_1M","TRANS_AMOUNT_TENDENCY3M",
    "TRANS_CNT_TENDENCY3M","PACK_102","PACK_103","PACK_104","PACK_105"
]

df = pd.DataFrame([record], columns=columns)
processed = preprocess_record(df)
print("Original record:")
print(df.head())
print("Processed record:")
print(processed.head())